# 최종 프로젝트
- 붕괴 및 화재 건물내에서 구조 가능한 로봇
# 하드웨어 구성도
![스크린샷 2024-12-12 21-06-17](https://github.com/user-attachments/assets/e2c98330-53e2-46c0-bd2c-df7ce41aba47)
<hr/>

# 시퀀스 구상도
![스크린샷 2024-12-12 22-04-07](https://github.com/user-attachments/assets/6e97b6d0-b16d-4179-8ffa-832161113779)
<hr/>

# 프로젝트 멤버
- 김재환, 장재희, 하정민
# 구현 할 주 기능
- 360도 음성 감지 및 추적
  - 음성 인식 후 방향 탐지 능력의 정확도가 70%정도임
  - custom_bringup, custom_serviece 패키지로 관련 기능 구현
- 사물과 사람을 구분하여 인식
  - realsense_ros 패키지 사용
  - 사람이면 True, 사물이면 False 토픽 발행 노드 구현
- 배터리 부족시 허브로 돌아가 자동충전
  - 배터리 부족을 판단할 노드를 생성할 수 없음
  - 관련 패키지가 험블 이상 버전을 지원해서 의존성 문제로 폭시환경에서는 어려움이 있음
  - 전체 시퀸스 종료 시 혹은 특정 명령시 충전소로 돌아가는것으로 변경
<hr/>

# 프로젝트 전체 완성률 < 82% >
<hr/>

## 사고구조 로봇 하드웨어 제작
- 구현률 : 100%(누적)
- 24.11.25(오전), 하드웨어 30% 조립/김재환, 장재희, 하정민
  - 터틀봇 3대, Autocar jetson 분해 
- 24.11.25(오후), 하드웨어 30% 조립/김재환, 장재희, 하정민
  - 터틀봇 와플조립, 오픈 매니퓰레이터 조립
- 24.11.28(오전), 하드웨어 35% 조립/김재환
  - opencr 보드 설정, jetson os 업로드, 기타 전선 제작
- 24.12.05(오후), 하드웨어 5% 조립/ 김재환
  - 자동충전용 커넥터 제작 및 설치
  - 동작전 최종 점검 완료
<hr/>

## 하드웨어 브링업
- 구현률 : 100%(누적)
- 24.11.28(오후), 하드웨어 브링업 5% 작업, 김재환
  - ros-foxy 설치, turtlebot_lib설치, 센서관련 드라이버 설치
  - 참고한 링크-https://docs.ros.org/en/foxy/Installation/Ubuntu-Install-Debians.html
  - 참고한 링크-https://emanual.robotis.com/docs/en/platform/turtlebot3/manipulation/#turtlebot3-with-openmanipulator  
- 24.11.29(오전), 하드웨어 브링업 5% 작업, 김재환
  - 브링업 관련 보드 및 dc모터 점검
- 24.11.29(오후), 하드웨어 브링업 10% 작업, 김재환
  - opencr 보드 펌웨어 점검, ros_domain 설정, teleop control 확인
- 24.12.02(오전) 하드웨어 브링업 5% 작업, 김재환
  - [ros2_control_node-2] [ERROR] [DynamixelSDKWrapper] [TxRxResult] There is no status packet!
  - 브링업중 위 에러 원인 찾기 
  - 해결책 1. 노트북에 도커를 설치해서 폭시로 버전 맞추어 브링업 X
  - 해결책 2. 터틀봇에 패키지를 핫픽스 버전으로 재설치 X
  - 해결책 3. 브링업 및 서보 관련 파일 전부 호환성 체크 X
  - 해결불가, 작동에 영향없음
- 24.12.02(오후) 하드웨어 브링업 2% 작업, 김재환
  - 기존 teleop코드가 tf의 위치를 기준으로 키보드의 입력을 받아 moveit으로 자동계산 되어 움직임이 산출됨, 조금만 움직이면 임계값에 도달하여 시스템이 죽음
  - moveit을 사용하지 않은 teleop 코드 작성
- 24.12.03(오전) 하드웨어 브링업 2% 작업, 김재환
  - moveit없이 파이썬으로 코드를 작성했지만 여전히 매니풀레이터 작동 불능
  - 해결책 1. 서비스 노드로 직접 값을 전달
  - 해결책 2. 하드웨어 브링업으로 생성되는 액션 노드를 활용해 값을 전달
- 24.12.03(오후) 하드웨어 브링업 3% 작업, 김재환
  - 해결잭 1. 시도: 조인트 각도를 조절할수 있는 서비스를 발행하지 않아서 직업 서비스 코드를 추가해야 하지만 액션서버가 활성화 되기때문에 스킵함
  - 해결책 2. 시도: 액션으로는 조정가능함을 확인
- 24.12.04(오전) 하드웨어 브링업 5%, 김재환
  - 3가지 포지션 값을 액션서버에 명시해놓고 토픽 발행으로 mode1 이라는 값이 들어오면 조인트가 움직이는 코드 작성
      - 단발성 토픽으로 mode를 3개로 나누어 구현, 로봇 팔 구동에 큰 문제는 없었음, 다만 토픽일 경우에 2개이상의 토픽이 동시에 오면 메세지가 스킵되는 경우가 있었음
  - 두 방법의 효율 비교
- 24.12.04(오후) 하드웨어 브링업 3%, 김재환
  - 3가지 포지션 값을 액션서버에 명시해놓고 서비스콜로 mode1 이라는 값이 들어오면 조인트가 움직이는 코드 작성
      - 서비스서버가 구동중인 상태에서 서비스 콜로 mode1을 주면 조건에 따른 결과 행동이 정상적으로 작동됨
      - 유지보수 측면에서 더 효율이 좋을 것으로 판단됨 
  - 명령으로 wheel 조종 linear와 angler 값이 서로 바뀌어 있음 발견
- 24.12.05(오전) 하드웨어 브링업 10%, 김재환
  - 4-mic 장착, 관련 pip 라이브러리 설치
  - 마이크 정상입력 확인, 스피커 정상출력 확인
- 24.12.10(오전) 하드웨어 브링업 10%, 김재환
  - 직진중 angler가 돌아가는 이상현상 수리중
  - 코드분석 후 펌웨어 이상 X
  - 가제보 환경에선 동작 문제 X
  - opencr보드의 imu센서 이상으로 확인되어 보드 교체 후에도 현성 지속됨
  - imu 이상으로 Lidar 만으로 odom을 발행 하는 것으로 변경함
- 24.12.10(오후) 하드웨어 브링업 20%, 김재환
  - imu 이상으로 Lidar 만으로 odom을 발행 하는 것으로 변경하기 위해 /odom 토픽을 리맵핑으로 /odom_old로 바꿧으나 적용되지 않음
  - TF가 받는 odom id를 Lio-sam 노드가 출력하는 odom id로 변경, lio-sim이 험블에서만 오류없이 빌드 되어서 폭시인 현재 젯슨 자비에 nx에서 사용하는데 어려움이 있음
  - 20.04에 docker로 험블을 사용하는걸로 다음에 시도 해보면 좋을것 같음
  - wheel 서보모터가 매니퓰레이터 관절을 id만 바꿔서 장착한 것이 문제였고 기존 버거 서보모터로 교체후 tf회전 현상 없어짐
- 24.12.12(오전) 하드웨어 브링업20%, 김재환
  - realsense SDK 및 realsense wrapper 설치
  - realsense-viewer로 카메라 정상 연결 및 작동 확인
  - 참고한 링크-https://github.com/IntelRealSense/realsense-ros
<hr/> 

## 오프라인 음성 인식 엔진 기반 360도 음성 감지 및 추적
- 구현률 : 100%
- 24.11.28(오전) 음성 인식 엔진 학습 2%, 장재희
  - Google Assistant API 사용 방법 학습
- 24.11.28(오후) 하드웨어 탐구 2%, 장재희
  - ReSpeaker USB Mic Array 사용 방법 학습
  - 참고한 링크-https://wiki.seeedstudio.com/ReSpeaker-USB-Mic-Array/
- 24.11.29(오전) 음성 인식 엔진 학습 2%, 장재희
  - OpenAI Whisper 사용 방법 학습
  - OpenAI Whisper 설치
  - whisper_test.py 작성
- 24.11.29(오후) 음성 인식 엔진 학습 2%, 장재희
  - whisper_test.py 수정 및 테스트
- 24.12.03(오전) 음성 인식 엔진 학습 2%, 장재희
  - respeaker_turtlebot_test.py 작성
  - respeaker_turtlebot_test.py 테스트
- 24.12.03(오후) 음성 인식 엔진 학습 2%, 장재희
  - respeaker_turtlebot.py 작성
- 24.12.04(오전) 음성 인식 엔진 학습 2%, 장재희
  - respeaker_turtlebot.py 작성 및 수정
- 24.12.04(오후) 음성 인식 엔진 학습 2%, 장재희
  - respeaker_turtlebot.py 오류 수정
  - respeaker_turtlebot.py 테스트
- 24.12.05(오후) speech_recognition 엔진 기반 음성 감지 및 각도 출력 노드 설정 50%, 김재환
  - speech_recognition 엔진은 온라인 클라우드 서비스 기반이어서 오프라인 환경에 제한이 있을수 있으므로 오프라인 엔진으로 교체할 예정
- 24.12.06(오전) 오프라인 한국어 인식 엔진 사용 노드 제작 2%, 김재환
  - vosk 음성 인식 엔진 학습 
- 24.12.06(오후) 오프라인 한국어 인식 엔진 사용 노드 제작 2%, 김재환
  - 출력각도를 /cmd_vel에 전달할 angler.z로 변환시키는 모듈 제작 후 토픽 퍼블리싱
  - odom이 동기화 할수있는 최대 twist 속도가 있는데 기본 터블봇버거는 0.03이상 회전시 odom이 버티지 못했음
  - 현재 제작된 기체에서 실험해본 결과 linear.x를 0.1을 주었는데 tf가 왼쪽을 회전하는 현상을 발견함
  - odom fix 필요
- 24.12.11(오전) 오프라인 한국어 인식 엔진 사용 노드 제작 15%, 김재환
  - 소리위치 파악 후 각도 토픽 발행 노드 제작
  - 각도 토픽 구독후 값을 변환해서 /cmd_vel 토픽 발행 노드 제작
- 24.12.11(오후) 오프라인 한국어 인식 엔진 사용 노드 제작 15%, 김재환
  - custom_bringup 패키지에 추가 및 런치 점검
<hr/>

## 사물과 사람을 구분하여 인식
- 구현률 : 70%(누적)
- 24.11.25(오전), 기본 소프트웨어 작업 10%, 하정민
  - ubuntu환경에서 realsense 정상 작동 확인
- 24.11.25(오후), 기본 소프트웨어 작업 10%, 하정민
  - realsense 기본 코드 테스트 및 호환성 점검
- 24.12.10(오전), 기본 소프트웨어 작업 5%, 하정민
  - 유튜브 영상 참고 https://www.youtube.com/watch?v=xqroBkpf3lY 
  - python3-pip, python-deteutil 설치
  - NAVIDI Installing PyTorch for Jetson Platform 사이트의 Prerequisites and Installation를 참고하여 v512 pytorch 설치
- 24.12.10(오후), 기본 소프트웨어 작업 5%, 하정민
  - NVIDIA PyTorch for Jetson 사이트의 Installation을 참고하여 v0.16.0 설치
- 24.12.11(오전), 기본 소프트웨어 작업 10%, 하정민
    - Jetson Nano에서 Intel RealSense 카메라를 사용하기 위해 git을 통해 librealsense를 설치
- 24.12.11(오후), 기본 소프트웨어 작업 10%, 하정민
  -  ./buildLibrealsense.sh -j 2 명령어를 사용해 빌드를 하는 중 GCC와 CUDA 버전은 9.X로 되어 있어야 한다.
  -  python3 yolov8_rs.py 를 통해 realsense d435 카메라를 통해 yolo인식이 되는 것을 확인
- 24.12.12(오후), 기본 소프트웨어 작업 20%, 김재환
  - ros2-foxy 환경에서는 python 3.8을 기준으로 하기때문에 yolov5까지만 사용가능함
  - yolov5 설치
  - yolov5를 사용하는 물체인식 오픈소스 패키지를 설치함
  - 참고한 링크-https://github.com/Ar-Ray-code/YOLOv5-ROS?tab=readme-ov-file
<hr/>

## 배터리 부족시 허브로 돌아가 자동충전
- 구현률 : 50%(누적)
- 24.11.25(오전), 하드웨어 구성 20%/김재환
  - 충전허브 3D 모델링, 실물 출력
  - 제작모델 링크-https://www.tinkercad.com/users/2pODkDPEdpH
- 24.11.25(오전), 하드웨어 구성 20%/김재환
  - 출력물 조립, 충전 전선 제작
- 24.12.12(오후), 맵작성 10% 장재희
  - 버거를 이용해 카토그래퍼로 맵 그리기
  - 그려진 맵과 똑같은 환경을 가제보로 제작
  - /battery_state라는 정수형 토픽이 30 이하면 특정한 위치로 이동하게 만들기
- 24.12.??(오전), 하드웨어 구성 ??%/김재환
  - slam 맵 기반 자동충전 위치 설정
<hr/>

